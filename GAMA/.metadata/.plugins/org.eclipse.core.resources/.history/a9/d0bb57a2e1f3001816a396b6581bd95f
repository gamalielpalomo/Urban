/**
* Name: GISmodel
* Author: gamaa
* Description: 
* Tags: Tag1, Tag2, TagN
*/

model GISmodel

/* Insert your model definition here */

global{
	file<geometry> calles <- osm_file("/miramar/0409/miramar040918.osm");
	file lugares <- file("/miramar/0515/miramar051518-places.shp");
	
	geometry shape <- envelope(calles);
	
	init{
		//Importamos del archivo GIS las formas que nos interesan y creamos agentes tipo calle
		create agente_osm from:calles with: [tipo::string(read("highway")),nombre::string(read("name"))];
		ask agente_osm{
				if(tipo != nil and tipo != "" and tipo != "turning_circle" and tipo != "traffic_signals" and tipo != "bus_stop"){
					create calle with: [shape::shape, tipo:: tipo, nombre::nombre];
					if self.nombre = nil{
						self.nombre <- "sin nombre";
					}
				}
			do die;
		}
		
		//Importamos del archivo GIS las formas que nos interesan y creamos agentes tipo calle
		create agente_osm from: lugares with: [tipo::string(read("amenity")), name_str::string(read("name"))]{
			if tipo != nil and tipo != "" or place_str != ""{
				create places with: [shape::shape, amenity::amenity, name_str::name_str,place_str::place_str]{
					if place_str = "neighbourhood" or place_str = "suburb"{
						add(self) to: suburbs;
					}
				}
			}
			do die;
		}
		
	}
}

species agente_osm{
	string nombre;
	string tipo;
}
species calle{
	string nombre;
	string tipo;
}